#!/usr/bin/env pwsh

#========================================================================
# スクリーンショットを取得する
#========================================================================

#========================================================================
# 引数を処理
#   -URL url		WebリソースのURL
#   -Agent agent	リクエストで使うエージェントを指定
#========================================================================
Param(
	[Parameter(Mandatory=$true)][String]$URL = ""
)

#========================================================================
# デフォルトのスクリーンショットファイル
#========================================================================
$outfile="${env:HOME}/ss.png"

#========================================================================
# スクリーンショットの取得に利用するアプリケーション
#========================================================================
$msedge='C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe'

#========================================================================
# どの方法でスクリーンショットを取得するかを判断
#========================================================================
$method='msedge'

#========================================================================
# Webページのスクリーンショットを取得
#========================================================================
switch ($method)
{
	#================================================================
	# Microsoft Edgeを使って取得
	#================================================================
	'msedge'
	{
		$o1='--headless'
		$o2='--screenshot="' + ${outfile} + '"'

		Start-Process	-FilePath $msedge			`
				-ArgumentList $o1,$o2,$URL		`
				-Wait
		break
	}
}
