#!/usr/bin/env pwsh

#========================================================================
# URI(HTML)の指定したXPathからテキストを取得する
#========================================================================

#========================================================================
# 引数を処理
#   -URI uri		対象となるHTMLのURI
#   -XPath xpath	Webサーバへ送るUser-Agent文字列を指定
#========================================================================
Param(
	[Parameter(Mandatory=$true)][String]$URI,
	[String]$XPath = "/html/body"
)

#========================================================================
# URIがローカルパスだった場合にはURI形式へ変更する
#========================================================================
switch  -Wildcard ($URI)
{
        'http*'
        {
                break
        }

        default
        {
		switch  -Wildcard ($env:OS)
		{
			'Windows*'
			{
				switch  -Wildcard ($URI)
				{
					'C:*'
					{
						$URI = 'file:///' + $URI
					}

					default
					{
						$URI = 'file:///C:' + $URI
					}
				}
			}

			default
			{
				$URI = 'file://' + $URI
			}
		}
        }
}

#========================================================================
# 制御用WebDriverを起動
#========================================================================
webdriver_edge_start.ps1					> $null

#========================================================================
# 指定されたURLをオープン
#========================================================================
Set-SeUrl -Url $URI

#========================================================================
# 指定された要素を取得
#========================================================================
$Element = Get-SeElement -By XPath -Value $XPath

#========================================================================
# 指定された要素の内容(テキスト)を出力
#========================================================================
$Element.Text

#========================================================================
# 制御用WebDriverを終了
#========================================================================
webdriver_edge_stop.ps1						> $null
