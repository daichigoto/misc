#!/bin/sh

[ "0" = $# ] && exit

case $(hostname -s) in
virt)
	case "$1" in
	msedge)
		exec ssh virthost \
			echo '"'start Shell:AppsFolder'\'Microsoft.MicrosoftEdge_8wekyb3d8bbwe!MicrosoftEdge $2'"' '>' .wincmdserver_cmd
		;;
	mail)
		exec ssh virthost echo "'& ''"C:\\Program Files\\Mozilla Thunderbird\\thunderbird.exe"'' -compose $2'" '>' .wincmdserver_cmd
		;;
	clip)
		tempfile=$(mktemp /tmp/win.XXXXXX) 
		cat $2 > "$tempfile"
		scp "$tempfile" virthost:.wincmdserver_clip
		rm -f "$tempfile"
		;;
	*)
		exec ssh virthost \
			echo '"'$*'"' '>' .wincmdserver_cmd
		;;
		esac
	;;
esac
