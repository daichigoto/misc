#!/bin/sh

case "$(uname)" in
# FreeBSD
FreeBSD)
	# BSDmake
	exec /usr/bin/make "${@}"
	;;
# Mac
Darwin)
	if [ -n "$(which bsdmake)" ]
	then
		brew install bsdmake
	fi

	case "$(pwd)" in
	${HOME}/Documents/*)
		# BSDmake
		exec $(which bsdmake | head -1) "${@}"
		;;
	*)
		# GNUmake
		exec /usr/bin/make "${@}"
		;;
	esac
	;;
# Windows MSYS2
MSYS*)
	# NOTICE:
	#
	# It is necessary to use only the command name, not the full path, 
	# so that it can be executed from both Windows and MSYS2. 
	# (Windows and MSYS2 have different ways of writing paths)
	#
	# GNUmake
	if [ -f Makefile.win ]
	then
		exec make.exe -f Makefile.win "${@}"
	else
		exec make.exe "${@}"
	fi
	;;
# Others
*)
	if [ -z "$(which make | grep -v ${0} | head -1)" ]
	then
		echo "no such hoge command: make" 1>&2
		exit 1
	else
		exec $(which make | grep -v ${0} | head -1) "${@}"
	fi
	;;
esac
